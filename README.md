# Marlin-Erzay3D
Прошивка Marlin 1.1.9 для принтеров Erzay3D

<img src="https://github.com/Robokinetics/Marlin-Erzay3D/blob/master/logo.png"/>

Оригинальная прошивка: https://github.com/MarlinFirmware/Marlin

## Основные особенности:
* Конфигурация для Delta;
* Рускоязычный интерфейс с небольшими исправлениями перевода;
* Поддержка SD-карт;
* Поддержка UBL (Унифицированное выравнивание стола);
* Поддержка команды G26 для печати калибровочной сетки;
* Поддержка комманды G33 для калибровки Delta-принтера;
* "Продвинутая пауза" - парковка печатающей головки во время паузы + возможность смены филамента;
* Функция смены, загрузки и выгрузки филамента;
* Активированный SPEAKER (бипер, пищалка), поддержка команды M300;
* Увеличенный диапазон допустимых температур печати для уменьшения вероятности ложного срабатывания защиты от теплоубегания;
* Фирменное окно приветствия;
* Отключено опускание печатающей головки по завершении операции Homing для предотвращения повреждения высоких напечатанных моделей;
* Активировано дополнительное меню "Быстрые команды" (Изменённое название "Свои команды"). Содержит в себе 5 функций:
    1) Домой (G28);
    2) Преднагрев PLA;
    3) Преднагрев ABS;
    4) Автокалибровка стола (G28\nG29 P1\nG29 T0\nG29 S-1\nG29 A\nM500);
	5) Полная автокалибровка (G28\nM502\nM500\nG33\nM500\nG29 P1\nG29 T0\nG29 S-1\nG29 A\nM500).
* Использоване EEPROM для хранения настроек;
* Увеличено время активности шаговых двигателей до двух часов с момента последнего движения;
* Плата BOARD_MKS_GEN_13, дисплей MKS_MINI_12864;
* Добавлена информация о серийном номере принтера;
* И прочее.


## Инструкция по установке для пинтеров Erzay3D:
1. Скачайте и распакуйте архив исходного кода прошивки;
2. Скачайте и установите Arduino IDE: https://www.arduino.cc/en/main/software
3. Запустите Arduino IDE и откройте через него файл Marlin/Marlin.ino;
4. Откройте вкладку "Version.h" и укажите серийный номер Вашего принтера, если он Вам известен в строке "#define SERIAL_NUMBER "XX-YYYY"", где XX-YYYY - серийный номер;
5. Во вкладке "Configuration.h" найдите строку "#define MACHINE_UUID "550d440c-df28-461b-86a7-f1ba3118b96c"" и укажите в нём UUID Вашего принтера, если он известен;
6. В строке "#define DELTA_PRINTABLE_RADIUS 100.0" укажите радиус области печати в мм, в строке "#define DELTA_DIAGONAL_ROD 320.0" укажите длину тяговых в мм;
7. Сделайте прочие изменения в файла "Configuration.h" и "Configuration_adv.h", если необходимо;
8. В меню "Инструменты->Плата" выберите плату, установленную на Вашем принтере (обычно это "Arduino/Genuino Mega or Mega2560")
9. В меню "Инструменты->Процессор" выберите процессор, установленный на Вашем принтере (обычно это "ATmega2560 (Mega2560)");
10. В меню "Инструменты->Программатор" выберите программатор, установленный на плате Вашего принтера (обычно это "AVR ISP");
11. Установите драйвер Вашего принтера, если это ещё не сделали;
12. Подключите Ваш принтер по USB порту, в меню "Инструменты->Порт" выберите порт Вашего принтера;
13. Убедитесь, что порт Вашего принтера не занят другими программа. Некоторые программы (например, Cura версии 3 и выше) занимают порт принтера, как только он будет подключен к ПК. Поэтому рекомендуется закрыть подобные программы;
14. Нажмите кнопку "Загрузить" в окне Arduino IDE;
15. Дождитесь загрузки прошивки на Ваш принтер. После удачной загрузки на дисплее должен появиться логотип и окно статуса;
16. Подключите принтер к сети питания, выполните операцию "Домой" из меню "Быстрые команды". При этом следите, чтобы все направляющие поднимались вверх и срабатывали концевики. <b>БУДЬТЕ ГОТОВЫ (!)</b> отключить питание, в случае неправильной работы . Если одна или более направляющих опускаются вниз, отключите питание, в файле "Configuration.h" поменяте значение (true на false, а false на true) у INVERT_X_DIR, INVERT_Y_DIR или INVERT_Z_DIR, соотвтетственно для каждого шагового двигателя, который двигается в противоположную от нужной сторону. После изменения повторите шаги 14-16;
17. Убедитесь, что датчик калибровки стола исправен и подключен к Вашему принтеру. Подготовьте стол, как если бы Вы собрались на нём печатать. В меню дисплея Вашего принтера откройте раздел "Быстрые команды", и выберите "Полная автокалибровка". Дождитесь, пока принтер выполнит калибровку. При этом следите, чтобы зонд не выходил за пределы стола. Все откалиброванные параметры сохранятся в EEPROM (энергонезависимая память) принтера;
18. Проверьте направление вращения шагового двигателя экструдера(ов) с помощью хост-программы или дисплея принтера, при этом нагрев экструдер до необходимой температуры печати. Если он движется в противоположную сторону поменяйте параметр INVERT_E0_DIR (true на false, а false на true) в файле "Configuration.h" и загрузите прошивку в принтер заново. Для многоэкструдерного принтера настройте параметры INVERT_E0_DIR, INVERT_E1_DIR, INVERT_E2_DIR и т.д. соотвтетственно для каждого экструдера;
19. Чтобы проверить качества калибровки используйте команду "G26 Bxx Hyy", где B - это температура нагрева стола (для PLA = 60, для ABS = 95), H - температура нагрева экструдера (для PLA = 210, для ABS = 240). Принтер начинает нагреваться до указанных температур и печатает тестовую сетку. Подробнее о калибровке читайте: http://3dtoday.ru/blogs/otumanov/ubl-or-how-to-get-a-perfect-first-layer/
20. <b>Принтер готов к работе</b>.

Подробнее о настройки прошивки для Delta-принтера: http://3dtoday.ru/blogs/xolodny/preparation-and-marlin-firmware-for-delta-printer/
